{
  "policies": {
    "production": {
      "default-src": ["'self'"],
      "script-src": [
        "'self'",
        "'unsafe-inline'", 
        "'unsafe-eval'",
        "https://fonts.googleapis.com",
        "https://www.google-analytics.com",
        "https://www.googletagmanager.com"
      ],
      "style-src": [
        "'self'",
        "'unsafe-inline'",
        "https://fonts.googleapis.com", 
        "https://fonts.gstatic.com"
      ],
      "font-src": [
        "'self'",
        "https://fonts.gstatic.com",
        "data:"
      ],
      "img-src": [
        "'self'",
        "data:",
        "https:",
        "blob:"
      ],
      "connect-src": [
        "'self'",
        "https:",
        "wss:",
        "https://api.facealert.security",
        "https://api.facealert.live",
        "https://fonts.googleapis.com"
      ],
      "frame-src": [
        "'self'",
        "https:"
      ],
      "object-src": ["'none'"],
      "base-uri": ["'self'"],
      "form-action": ["'self'", "https:"],
      "upgrade-insecure-requests": true
    },
    "development": {
      "default-src": ["'self'", "'unsafe-inline'", "'unsafe-eval'"],
      "script-src": [
        "'self'", 
        "'unsafe-inline'",
        "'unsafe-eval'",
        "localhost:*",
        "127.0.0.1:*",
        "0.0.0.0:*"
      ],
      "style-src": ["'self'", "'unsafe-inline'"],
      "img-src": ["'self'", "data:", "blob:", "https:"],
      "connect-src": [
        "'self'",
        "ws:",
        "wss:",
        "http:",
        "https:",
        "localhost:*",
        "127.0.0.1:*",
        "0.0.0.0:*"
      ],
      "font-src": ["'self'", "data:"]
    }
  },
  "reporting": {
    "report-uri": "/api/csp-report",
    "report-to": "csp-endpoint"
  },
  "notes": {
    "unsafe-inline": "Required for React inline styles",
    "unsafe-eval": "Required for Vite bundler in production",
    "blob": "Required for dynamic image generation",
    "data": "Required for base64 encoded assets"
  }
}
